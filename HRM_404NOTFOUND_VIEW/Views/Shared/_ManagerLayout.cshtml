<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>@ViewData["Title"] - Manager</title>
    @*<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />*@
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/lib/kendo/styles/default-main.css" asp-append-version="true" />
    @*<link rel="stylesheet" href="~/HRM_404NOTFOUND_VIEW.styles.css" asp-append-version="true" />*@
    <script src="~/lib/jquery/dist/jquery.min.js"></script>

    <link rel="apple-touch-icon" sizes="76x76" href="~/assets/img/apple-icon.png" />
    <link rel="icon" type="image/png" href="~/assets/img/favicon.ico" />
    <title>Human Resource Management</title>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no"
          name="viewport" />
    <!--     Fonts and icons     -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />
    <!-- CSS Files -->
    <link href="~/assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="~/assets/css/light-bootstrap-dashboard.css?v=2.0.0 " rel="stylesheet" />
    <!-- CSS Just for demo purpose, don't include it in your project -->
    <link href="~/assets/css/demo.css" rel="stylesheet" />

</head>
<body>
    <div class="wrapper">
        <div class="sidebar" data-image="https://firebasestorage.googleapis.com/v0/b/hrm-resource.appspot.com/o/sidebar-4.jpg?alt=media">
            <div class="sidebar-wrapper">
                <div class="logo">
                    <a class="simple-text"> Human Resource Management </a>
                </div>
                <ul class="nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/Manager/Profile">
                            <i class="nc-icon nc-circle-09"></i>
                            <p>User Profile</p>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/Manager/LeaveLogIndex">
                            <i class="nc-icon nc-notes"></i>
                            <p>Leave Management</p>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/Manager/OvertimeLogIndex">
                            <i class="nc-icon nc-paper-2"></i>
                            <p>Overtime Management</p>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/Manager/EmployeeIndex">
                            <i class="nc-icon nc-notes"></i>
                            <p>Employee Project</p>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/Manager/Income">
                            <i class="nc-icon nc-notes"></i>
                            <p>Your Income</p>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/Manager/NotificationIndex">
                            <i class="nc-icon nc-bell-55"></i>
                            <p>Notifications</p>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="logout" href="/Auth/Logout">
                            <i class="nc-icon nc-circle-09"></i>
                            <p>Logout</p>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="main-panel">
            <!-- Navbar -->
            <nav class="navbar navbar-expand-lg" color-on-scroll="500">
                <div class="container-fluid">
                    <a class="navbar-brand" href="#pablo"> @ViewData["Title"] </a>
                    <button href=""
                            class="navbar-toggler navbar-toggler-right"
                            type="button"
                            data-toggle="collapse"
                            aria-controls="navigation-index"
                            aria-expanded="false"
                            aria-label="Toggle navigation">
                        <span class="navbar-toggler-bar burger-lines"></span>
                        <span class="navbar-toggler-bar burger-lines"></span>
                        <span class="navbar-toggler-bar burger-lines"></span>
                    </button>
                    <div class="collapse navbar-collapse justify-content-end"
                         id="navigation">
                        <ul class="nav navbar-nav mr-auto">
                            <li class="nav-item">
                                <a href="#" class="nav-link" data-toggle="dropdown">
                                    <span class="d-lg-none">@ViewData["Title"]</span>
                                </a>
                            </li>
                            <li class="dropdown nav-item">
                                <a href="#"
                                   class="dropdown-toggle nav-link"
                                   data-toggle="dropdown">
                                    <i class="nc-icon nc-planet"></i>
                                    <span class="d-lg-none">Notification</span>
                                </a>
                                <ul id="NotificaitonMenu" class="dropdown-menu">
                                </ul>
                            </li>
                        </ul>
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="/Manager/Profile">
                                    <span class="no-icon">Account</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" onclick="logout" asp-controller="Auth" asp-action="Logout">
                                    <span class="no-icon">Log out</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>

            <div class="container">
                <main role="main" class="pb-3">
                    @RenderBody()
                </main>
            </div>
            <footer class="footer">
                <div class="container-fluid" style="">
                    <nav>
                        <p class="copyright text-center">
                            ©
                            <script>
                                document.write(new Date().getFullYear());
                            </script>
                            <a href="#">Human Resource Management</a>, made
                            with love for a better management app
                        </p>
                    </nav>
                </div>
            </footer>
        </div>
    </div>

    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="~/lib/kendo/js/kendo.all.min.js"></script>
    <script src="~/lib/kendo/js/angular.min.js"></script>
    <script src="~/lib/kendo/js/jszip.min.js"></script>

    <script src="~/assets/js/core/popper.min.js" type="text/javascript"></script>
    <script src="~/assets/js/core/bootstrap.min.js"
            type="text/javascript"></script>
    <!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
    <script src="~/assets/js/plugins/bootstrap-switch.js"></script>
    <!--  Notifications Plugin    -->
    <script src="~/assets/js/plugins/bootstrap-notify.js"></script>
    <!-- Control Center for Light Bootstrap Dashboard: scripts for the example pages etc -->
    <script src="~/assets/js/light-bootstrap-dashboard.js?v=2.0.0 "
            type="text/javascript"></script>
    <!-- Light Bootstrap Dashboard DEMO methods, don't include it in your project! -->
    <script src="~/assets/js/demo.js"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>

<script>
    function truncateString(value, maxLength) {
        if (value && value.length > maxLength) {
            return value.substring(0, maxLength) + "...";
        }
        return value;
    }
</script>
<script>
    function logout() {
        sessionStorage.clear();
    }
</script>

@if (TempData["ACCESS_TOKEN"] != null)
{
    <text>
        <script>
            sessionStorage.setItem("ACCESS_TOKEN", '@TempData["ACCESS_TOKEN"]');
            sessionStorage.setItem("ROLE_NAME", '@TempData["ROLE_NAME"]');
            sessionStorage.setItem("EMPLOYEE_ID", '@TempData["EMPLOYEE_ID"]');
        </script>
    </text>
}
@if (TempData["Message"] != null)
{
    <text>
        <script>
            $(document).ready(function () {

                demo.showNotification('@TempData["Message"]', 1);
            });

        </script>
    </text>
}

@if (TempData["Error"] != null)
{
    <text>
        <script>
            $(document).ready(function () {

                demo.showNotification('@TempData["Error"]', 4);
            });

        </script>
    </text>
}

<script>
    $(function () {
        var currentUrl = window.location.pathname;
        var $navItems = $('.nav-item');

        $navItems.removeClass('active');

        $navItems.find('a[href="' + currentUrl + '"]').parent().addClass('active');
    });
</script>

@*<script type="text/javascript">
    $(document).ready(function () {
        ShowAllNotification();

        function ShowAllNotification() {
            $("#NotificaitonMenu").html("");
            $.ajax({
                url: "https://localhost:5000/api/Notification/" + sessionStorage.getItem('EMPLOYEE_ID'),
                type: "get",
                contentType: "application/json",
                beforeSend: function (xhr) {
                    xhr.setRequestHeader("Authorization", "Bearer " + sessionStorage.getItem('ACCESS_TOKEN'));
                },
                success: function (result, status, xhr) {
                    $.each(result["data"], function (index, value) {
                        console.log(value.notificationDetail);
                        var newNotification = $("<a>").addClass("dropdown-item").attr("href", "#").text(value["notificationDetail"]);
                        $("#NotificaitonMenu").append(newNotification);
                    });
                },
                error: function (xhr, status, error) {
                    console.log(xhr);
                },
            });
        }
    });
</script>*@
</html>
